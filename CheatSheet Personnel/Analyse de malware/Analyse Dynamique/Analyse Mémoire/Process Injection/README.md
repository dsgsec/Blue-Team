### Techniques d'Injection

#### 1. Process Injection

**Description :**
Le code malveillant est inséré dans un processus légitime en cours d'exécution. Cela permet au code malveillant de s'exécuter sous le couvert du processus légitime, rendant sa détection plus difficile.

**Exemple :**
Imaginez que vous avez un programme antivirus qui s'exécute sur votre ordinateur (processus légitime). Un attaquant peut utiliser Meterpreter pour insérer du code malveillant directement dans ce programme antivirus. Ainsi, le code malveillant s'exécute sous l'apparence de l'antivirus, évitant les mécanismes de détection classiques.

#### 2. Process Hollowing

**Description :**
Un processus légitime est d'abord exécuté puis le code de ce processus est remplacé par un programme malveillant. Le processus en cours est toujours vu comme légitime par l'utilisateur et le système, même s'il exécute un code malveillant.

**Exemple :**
Supposons que vous lancez votre navigateur web (processus légitime). L'attaquant utilise Meterpreter pour remplacer le code du navigateur par un programme malveillant tout en maintenant l'apparence du navigateur en cours d'exécution. Aux yeux de l'utilisateur, le navigateur fonctionne normalement, mais en réalité, il exécute des actions malveillantes en arrière-plan.

#### 3. DLL Injection

**Description :**
Une bibliothèque dynamique (DLL) est injectée dans un processus cible, forçant ce processus à charger et exécuter la DLL malveillante. Cette technique permet au code malveillant de s'exécuter dans le contexte du processus légitime.

**Exemple :**
Imaginez que vous utilisez un lecteur de musique (processus légitime). L'attaquant utilise Meterpreter pour injecter une DLL malveillante dans ce lecteur de musique. Désormais, chaque fois que le lecteur de musique s'exécute, il charge et exécute également la DLL malveillante, permettant à l'attaquant de prendre le contrôle ou d'exécuter des actions malveillantes.

---

Ces techniques d'injection sont puissantes car elles exploitent les processus légitimes pour dissimuler les activités malveillantes, rendant la détection par les outils de sécurité plus difficile. Meterpreter facilite l'implémentation de ces techniques, ce qui en fait un outil précieux pour les tests d'intrusion et l'évaluation des vulnérabilités.


1. Process Injection

+------------------+               +--------------------------+
|                  |               |                          |
| Processus        |               | Meterpreter              |
| Légitime         |               |                          |
| (ex: antivirus)  |               |                          |
|                  |               |                          |
| +--------------+ |               | +----------------------+ |
| | Code normal  | |               | | Injecte du code      | |
| +--------------+ |               | | malveillant dans     | |
|                  | +-----------> | | le processus         | |
|                  |               | +----------------------+ |
+------------------+               +--------------------------+

2. Process Hollowing

+------------------+               +--------------------------+
|                  |               |                          |
| Processus        |               | Meterpreter              |
| Légitime         |               |                          |
| (ex: navigateur) |               |                          |
|                  |               |                          |
| +--------------+ |               | +----------------------+ |
| | Code normal  | |               | | Lance le processus    | |
| +--------------+ |               | | légitime, puis        | |
|                  | +-----------> | | remplace son code     | |
|                  |               | | par du code           | |
|                  |               | | malveillant           | |
|                  |               | +----------------------+ |
+------------------+               +--------------------------+

3. DLL Injection

+------------------+               +--------------------------+
|                  |               |                          |
| Processus        |               | Meterpreter              |
| Légitime         |               |                          |
| (ex: lecteur     |               |                          |
| de musique)      |               |                          |
|                  |               |                          |
| +--------------+ |               | +----------------------+ |
| | Code normal  | |               | | Injecte une DLL       | |
| +--------------+ |               | | malveillante dans     | |
|                  | +-----------> | | le processus, forçant | |
|                  |               | | le processus à        | |
|                  |               | | charger et exécuter   | |
|                  |               | | la DLL                | |
|                  |               | +----------------------+ |
+------------------+               +--------------------------+
