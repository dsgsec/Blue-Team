CheatSheet Malware Analyse
--------------------

# Analyse statique

## Executable

### Indice d'exe douteux
- Nom aléatoire
- Nom proche d'un fichier légimite
  - svchooost.exe
  - svhost.exe
- Chemin d'execution anormal : appdata, tmp
- Présence de langue étrangère
- Présence de packer
- Présence de fonction suspecte dans la table d'import
  - OpenProcess
  - WriteProcessMemory
  - ShellExecuteA
 
----

### Détecter le packing
- Adresse de point d'entrée n'étant pas située daans une section standard
- Présence de section ayant un nom inhabituelle
```
objdump -h file.exe
```

#### entropie
- Entropie de fichier élevé
```
L'entropie de fichier est une note qui évalue le nombre de caractères aléatoire des données dans un fichier PE.

Avec une échelle de 0 à 8. 0 signifiant un nombre moins aléatoire des données dans le fichier et 8 indiquant un nombre de données plus aléatoires

Les fichiers chiffrés, compressés ou obfusqués auront un score d'entropie très élevé. Les fichiers contenant de gros morceaux des mêmes données, tels que des "1", auront un score d'entropie faible.

Si un analyste avait 1 000 fichiers, il pourrait classer les fichiers en fonction de leur score d'entropie, les fichiers avec l'entropie la plus élevée pourront être analysés en premier.
```

##### Commande
```
psecanner.py file.exe
```

#### Section vide
- Présence d'une section ayant pour taille 0 octet
```
peframe.py /Desktop/
```

#### Compliation depuis langage interprété puis décompilation
- On peut dé-compiler avec 
```
https://devextras.com/decompiler/
https://www.jetbrains.com/fr-fr/decompiler/
https://github.com/extremecoders-re/pyinstxtractor
https://github.com/rocky/python-uncompyle6/
http://java-decompiler.github.io/
```

