CheatSheet Malware Analyse
--------------------

# Maldoc

## Fichier PDF

### Instructions PDF
```
/AA : « Automatic Action », désigne une action qui est effectuée automatiquement lorsqu’un événement défini après la balise intervient

/OpenAction : pointe vers un objet qui est accédé lors de l’ouverture du document

/Javascript ou /JS : code JS ou d’un objet contenant lui-même du code JS

/RichMedia : l’objet associé peut contenir du code Flash

/Launch : Exécution d'un programme externe.

/EmbeddedFiles : Indique qu’un ou plusieurs fichiers sont présent dans le PDF

/Stream : Flux de données composant un objet

/Object : Dictionnaire contenant les propriétés d’un objet (Nom, taille, emplacement logique, etc ..)
```

### Analyse de fichier PDF
- peepdf permet de scanner des PDFs et afficher les objets de manière sommaire
```
/AA : « Automatic Action », désigne une action qui est effectuée automatiquement lorsqu’un événement défini après la balise intervient

/OpenAction : pointe vers un objet qui est accédé lors de l’ouverture du document

/Javascript ou /JS : code JS ou d’un objet contenant lui-même du code JS

/RichMedia : l’objet associé peut contenir du code Flash

/Launch : Exécution d'un programme externe.

/EmbeddedFiles : Indique qu’un ou plusieurs fichiers sont présent dans le PDF

/Stream : Flux de données composant un objet

/Object : Dictionnaire contenant les propriétés d’un objet (Nom, taille, emplacement logique, etc ..)
```

#### Outil :
- peepdf

### Analyse de fichier PDF et extraire le code malicieux
- pdf-parser permet de scanner des PDFs et détecter et extraire le code malicieux
```
python3 pdf-parser.py --search javascript evil.pdf
```

#### Outil :
- pdf-parser

### Manipulation de fichier pdf
- Le code javascript embarqué dans un PDF peut généralement être désobfusqué ou mener à un shellcode, D’autres outils pourront être utilisés en complément :
```
http://blog.didierstevens.com/programs/spidermonkey/ (Analyse de shellcode via JS)
```
## Fichier Office
