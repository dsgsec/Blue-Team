Introduction au Reverse Engineering
-----------------------------------

Le reverse engineering est le processus de compréhension de la conception et du fonctionnement d'un système à partir de son état final. Dans le domaine informatique, cela implique souvent l'analyse de logiciels pour en comprendre le fonctionnement interne, généralement dans le but de comprendre les algorithmes, de trouver des vulnérabilités de sécurité ou de rétro-ingénierie des protocoles.

Méthodologie d'Analyse
----------------------

### 1\. Graphe d'Exécution

Le graphe d'exécution permet d'obtenir l'algorithme du programme et par conséquent d'identifier le fil à suivre. Il est essentiel dans le processus de reverse engineering pour comprendre la logique du programme.

### 2\. Identification des Fonctions Intéressantes

Lire tout l'assembleur du programme est contre-productif en raison du grand nombre d'instructions. Ainsi, dans un premier temps, il est indispensable d'identifier les fonctions intéressantes du programme pour se concentrer sur les parties pertinentes de celui-ci.

### 3\. Analyse de la Fonction Main

L'analyse du programme commence toujours à partir de la fonction `main`, qui est généralement initialisée par l'entrypoint. C'est à partir de cette fonction que l'analyse se déploie pour comprendre la structure globale du programme.

### 4\. Instructions et Fonctions Pertinentes

Certaines instructions et fonctions permettent de cibler rapidement les éléments pertinents en fonction de l'objectif de l'analyse. Parmi celles-ci, on peut citer les instructions `call`, `jmp` ainsi que les appels de fonctions système telles que celles liées à la cryptographie, aux sockets, etc.

### 5\. Analyse Avancée

Une fois les bases de l'analyse posées, il est possible d'approfondir en utilisant des méthodes plus avancées telles que le patching et l'utilisation de breakpoints.

Exemple d'Analyse d'un PE x86 via Cutter
----------------------------------------

### Objectifs

Dans l'exemple suivant, le PE (Portable Executable) attend un argument/valeur. Lorsque cette valeur n'est pas correcte, le PE retourne la chaîne "Perdu !".

#### Éléments en Notre Possession

-   Chaîne "perdu !"

#### Code Source

```c
#include <stdio.h>

int main(void) {
    int i;
    i = 35;
    if (i == 42) {
        printf("Gagné !");
        return 0;
    } else {
        printf("Perdu !");
        return 1;
    }
}
```

### Analyse

En analysant la fonction `main` dans le graphe d'exécution, nous identifions l'appel à l'instruction `cmp` qui permet de comparer deux valeurs. Ensuite, l'instruction `JNE` (Jump Not Equal) redirige vers l'adresse mémoire correspondant à l'affichage de "Perdu !" si la comparaison est fausse. Sinon, le programme affiche "Gagné !".
