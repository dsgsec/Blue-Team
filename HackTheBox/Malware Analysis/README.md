Introduction aux logiciels malveillants et à l'analyse des logiciels malveillants
=================================================================================

Il est essentiel de préciser que ce module ne prétend pas être un programme global ou exhaustif sur Malware Analysis. Ce module fournit une base solide aux analystes SOC, leur permettant d'aborder en toute confiance les tâches clés d'analyse des logiciels malveillants. L'objectif principal du module sera l'analyse des logiciels malveillants ciblant le système d'exploitation Windows.

Définition des logiciels malveillants
-------------------------------------

`Malware`, abréviation de logiciel malveillant, est un terme englobant divers types de logiciels conçus pour infiltrer, exploiter ou endommager les systèmes informatiques, les réseaux et les données.

Bien que tous les logiciels malveillants soient utilisés à des fins malveillantes, leurs objectifs spécifiques peuvent varier selon les différents acteurs de la menace. Ces objectifs se répartissent généralement en plusieurs catégories :

-   Perturbation des opérations du système hôte
-   Voler des informations critiques, y compris des données personnelles et financières
-   Obtenir un accès non autorisé aux systèmes
-   Mener des activités d'espionnage
-   Envoi de messages spam
-   Utiliser le système de la victime pour des attaques par déni de service distribué (DDoS)
-   Mise en œuvre d'un ransomware pour verrouiller les fichiers de la victime sur son hôte et exiger une rançon

Types de logiciels malveillants
-------------------------------

Dans le monde actuel des cybermenaces, en évolution rapide, nous nous trouvons confrontés à un large éventail de formes de logiciels malveillants complexes et variés, qui posent un défi constant à nos cyberdéfenses. Il est primordial pour nous de comprendre la nature multiforme des logiciels malveillants alors que nous nous efforçons de renforcer la sécurité de nos systèmes et réseaux. Examinons les couches de certains types de logiciels malveillants couramment rencontrés avec lesquels nous sommes fréquemment confrontés dans nos efforts de cybersécurité.

-   `Viruses`: Ces formes notoires de logiciels malveillants sont conçues pour s'infiltrer et se multiplier dans les fichiers hôtes, passant d'un système à un autre. Ils s'accrochent à des programmes crédibles et entrent en action lorsque les fichiers infectés sont déclenchés. Leurs pouvoirs destructeurs peuvent aller de la corruption ou de l'altération des données à la perturbation des fonctions du système, voire même à leur propagation à travers les réseaux, provoquant ainsi des ravages généralisés.

-   `Worms`: Les vers sont des logiciels malveillants autonomes capables de se multiplier sur les réseaux sans nécessiter d'intervention humaine. Ils exploitent les faiblesses du réseau pour infiltrer les systèmes sans autorisation. Une fois à l'intérieur, ils peuvent soit délivrer des charges utiles dommageables, soit continuer à se multiplier sur d'autres appareils vulnérables. Les vers peuvent déclencher des infections rapides et croissantes, entraînant d'énormes perturbations, voire des attaques potentielles par déni de service.

-   `Trojans`: Également connus sous le nom de chevaux de Troie, ils sont déguisés en véritables logiciels pour inciter les utilisateurs à les exécuter. En entrant dans un système, ils créent des portes dérobées, permettant aux attaquants d'obtenir un contrôle à distance non autorisé. Les chevaux de Troie peuvent être utilisés pour voler des données sensibles, telles que des mots de passe ou des informations financières, et orchestrer d'autres activités nuisibles sur le système compromis.

-   `Ransomware`: Ce type de malware malveillant crypte les fichiers sur le système de la cible, les rendant inaccessibles. Les attaquants exigent ensuite une rançon en échange de la clé de déchiffrement, retenant ainsi les données de la victime contre une rançon. Les impacts des attaques de ransomware peuvent affaiblir les organisations et les individus, entraînant de graves dommages financiers et de réputation.

-   `Spyware`: Ce type de malware rassemble furtivement des données sensibles et des activités des utilisateurs sans leur consentement. Il peut suivre les habitudes de navigation en ligne, enregistrer les frappes au clavier et capturer les informations de connexion, ce qui présente un risque grave pour la confidentialité et la sécurité. Les données volées sont souvent envoyées à des serveurs distants à des fins nuisibles.

-   `Adware`: Bien qu'ils ne soient pas aussi destructeurs, les logiciels publicitaires peuvent néanmoins constituer une nuisance et une menace pour la sécurité. Il affiche des publicités indésirables et invasives sur les systèmes infectés, ce qui entraîne souvent une mauvaise expérience utilisateur. Les logiciels publicitaires peuvent également suivre le comportement des utilisateurs et collecter des données à des fins de publicité ciblée.

-   `Botnets`: Il s'agit de réseaux d'appareils compromis, souvent appelés robots ou zombies, contrôlés par un serveur central de commande et de contrôle (C2). Les botnets peuvent être exploités pour diverses activités nuisibles, notamment le lancement d'attaques DDoS, la diffusion de spam ou la diffusion d'autres logiciels malveillants.

-   `Rootkits`: Il s'agit de formes furtives de logiciels malveillants conçues pour obtenir un accès non autorisé et un contrôle sur les composants fondamentaux (la « racine ») d'un système d'exploitation. Ils modifient les fonctions du système pour dissimuler leur présence, ce qui les rend extrêmement difficiles à repérer et à éliminer. Les attaquants peuvent utiliser des rootkits pour maintenir un accès prolongé et contourner les protocoles de sécurité.

-   `Backdoors/RATs (Remote Access Trojans)`: Les portes dérobées et les RAT sont conçus pour offrir un accès et un contrôle non autorisés sur les systèmes compromis à partir d'emplacements distants. Les attaquants peuvent les exploiter pour conserver un contrôle prolongé, extraire des données ou lancer des attaques supplémentaires.

-   `Droppers`: Il s'agit d'une sorte de malware utilisé pour transporter et installer des charges utiles malveillantes supplémentaires sur les systèmes infectés. Ils servent de canal à d'autres logiciels malveillants, garantissant l'installation secrète et l'exécution de menaces plus sophistiquées.

-   `Information Stealers`: ceux-ci sont conçus pour cibler et extraire des données sensibles, telles que les identifiants de connexion, les informations personnelles ou la propriété intellectuelle, à des fins nuisibles. Cela inclut le vol d'identité ou la vente de données sur le dark web.

Ces exemples ne font qu'effleurer la surface des types de logiciels malveillants auxquels nous sommes confrontés dans le paysage actuel des menaces. Il est essentiel de se rappeler que les cybercriminels affinent constamment leurs stratégies, techniques et variantes de logiciels malveillants pour éviter d'être détectés et exploiter de nouvelles vulnérabilités.

Exemples de logiciels malveillants
----------------------------------

Lorsqu'il s'agit de renforcer nos défenses en matière de cybersécurité et de comprendre les menaces qui existent, nous devons parfois plonger dans les recoins sombres du cybermonde. Cela signifie mettre la main sur de véritables échantillons de logiciels malveillants, que ce soit à des fins de recherche, d'analyse ou à des fins éducatives. Cependant, il est crucial de souligner que le traitement des échantillons réels de logiciels malveillants doit être effectué dans un environnement sûr et contrôlé afin de prévenir les infections accidentelles et les dommages potentiels. Voici quelques ressources, gratuites et payantes, où nous pouvons trouver de tels échantillons.

-   [VirusShare](https://virusshare.com/) : Excellente ressource pour les chercheurs en logiciels malveillants, VirusShare héberge une vaste collection d'échantillons de logiciels malveillants. Ils disposent actuellement de plus de 30 millions d'échantillons dans leur banque, tous accessibles gratuitement au public.
-   [Analyse hybride](https://www.hybrid-analysis.com/) : ce site Web nous permet de soumettre des fichiers pour analyse de logiciels malveillants. Cependant, ils disposent également d'un flux public de leurs analyses, où des échantillons de logiciels malveillants sont souvent partagés.
-   [TheZoo](https://github.com/ytisf/theZoo) : Un référentiel GitHub qui contient une collection de logiciels malveillants en direct à des fins d'analyse et d'éducation. Le référentiel contient également des informations supplémentaires sur chaque échantillon, telles que sa famille et le type d'activités qu'il effectue.
-   [Malware-Traffic-Analysis.net](https://malware-traffic-analysis.net/) : ce site Web propose des exercices d'analyse du trafic qui peuvent être extrêmement utiles pour les personnes essayant d'en savoir plus sur les modèles de trafic de logiciels malveillants. Ils fournissent souvent des fichiers pcap du trafic réel de logiciels malveillants, ce qui peut être très informatif.
-   [VirusTotal](https://www.virustotal.com/) : VirusTotal inspecte les éléments avec plus de 70 scanners antivirus et services de liste de blocage d'URL/domaines, en plus d'une myriade d'outils pour extraire les signaux du contenu étudié. Tout utilisateur peut sélectionner un fichier sur son ordinateur à l'aide de son navigateur et l'envoyer à VirusTotal. VirusTotal propose un certain nombre de méthodes de soumission de fichiers, notamment l'interface Web publique principale, les téléchargeurs de bureau, les extensions de navigateur et une API programmatique.
-   [ANY.RUN](https://app.any.run/) : Un bac à sable interactif en ligne pour l'analyse des logiciels malveillants. Le service permet aux chercheurs d'analyser le comportement des logiciels malveillants en exécutant des échantillons dans un environnement contrôlé. Bien qu'elle propose des niveaux gratuits et payants, même la version gratuite donne accès aux soumissions publiques, qui peuvent inclure divers échantillons de logiciels malveillants.
-   [Contagio Malware Dump](https://contagiodump.blogspot.com/) : Contagio Dump est une collection d'échantillons de logiciels malveillants, de rapports sur les menaces et de ressources associées organisées par un chercheur en logiciels malveillants nommé Mila. Le site offre un accès direct et anonyme à une vaste gamme d'échantillons de logiciels malveillants, notamment divers types de chevaux de Troie, de vers, de ransomwares et d'exploits. Il est fréquemment utilisé par les chercheurs et les analystes en sécurité pour étudier le comportement des logiciels malveillants et développer des techniques d'atténuation.
-   [VX Underground](https://www.vx-underground.org/) : VX-Underground est l'une des plus grandes collections de codes sources, d'articles et de documents de logiciels malveillants sur Internet. Il vise à collecter, préserver et partager toutes sortes de documents liés à la culture des logiciels malveillants, des exploits et du piratage. Cette ressource est précieuse pour les chercheurs et les passionnés de sécurité qui souhaitent étudier la construction et le comportement des logiciels malveillants d'un point de vue plus technique et centré sur le code.

Acquisition de logiciels malveillants/preuves
---------------------------------------------

Lorsqu'il s'agit de rassembler des preuves lors d'une enquête médico-légale numérique ou d'une réponse à un incident, il est crucial de disposer des bons outils pour effectuer l'imagerie disque et l'acquisition de mémoire. Discutons de quelques solutions gratuites que nous pouvons utiliser pour collecter les données nécessaires à nos enquêtes.

### Solutions d'imagerie disque

-   [FTK Imager](https://www.exterro.com/ftk-imager) : Développé par AccessData (maintenant acquis par Exterro), FTK Imager est l'un des outils d'imagerie disque les plus utilisés dans le domaine de la cybersécurité. Il nous permet de créer des copies (ou images) parfaites de disques informatiques à des fins d'analyse, en préservant l'intégrité des preuves. Il nous permet également de visualiser et d'analyser le contenu des périphériques de stockage de données sans altérer les données.
-   [OSFClone](https://www.osforensics.com/tools/create-disk-images.html) : Un utilitaire gratuit et open source conçu pour la tâche de création et de clonage d'images disque médico-légales. Il est facile à utiliser et prend en charge une grande variété de systèmes de fichiers.
-   `DD and DCFLDD`: Les deux sont des utilitaires de ligne de commande disponibles sur les systèmes Unix (y compris Linux et MacOS). DD est un outil polyvalent inclus par défaut dans la plupart des systèmes basés sur Unix, tandis que DCFLDD est une version améliorée de DD avec des fonctionnalités spécifiquement utiles pour la médecine légale, telles que le hachage.

### Solutions d'acquisition de mémoire

-   [DumpIt](https://www.magnetforensics.com/resources/magnet-dumpit-for-windows/) : Un utilitaire simpliste qui génère un vidage de la mémoire physique des machines Windows et Linux. Sous Windows, il concatène la mémoire physique système 32 bits et 64 bits en un seul fichier de sortie, ce qui le rend extrêmement facile à utiliser.
-   [MemDump](http://www.nirsoft.net/utils/nircmd.html) : MemDump est un utilitaire de ligne de commande gratuit et simple qui nous permet de capturer le contenu de la RAM d'un système. C'est très utile dans les enquêtes médico-légales ou lors de l'analyse d'un système à la recherche d'activités malveillantes. Sa simplicité et sa facilité d'utilisation en font un choix populaire pour l'acquisition de mémoire.
-   [Belkasoft RAM Capturer](https://belkasoft.com/ram-capturer) : Il s'agit d'un autre outil puissant que nous pouvons utiliser pour l'acquisition de mémoire, fourni gratuitement par Belkasoft. Il peut capturer la RAM d'un ordinateur Windows fonctionnant sous Windows, même s'il existe une protection anti-débogage ou anti-dumping active. Cela en fait un outil très efficace pour extraire autant de données que possible lors d'une enquête médico-légale en direct.
-   [Magnet RAM Capture](https://www.magnetforensics.com/resources/magnet-ram-capture/) : Développé par Magnet Forensics, cet outil offre un moyen gratuit et simple de capturer la mémoire volatile d'un système.
-   [LiME (Linux Memory Extractor)](https://github.com/504ensicsLabs/LiME) : LiME est un Loadable Kernel Module (LKM) qui permet l'acquisition de mémoire volatile. LiME est unique dans le sens où il est conçu pour être transparent pour le système cible, évitant ainsi de nombreuses mesures anti-criminelles courantes.

### Autres solutions d'acquisition de preuves

-   [KAPE (Kroll Artifact Parser and Extractor)](https://www.kroll.com/en/services/cyber-risk/incident-response-litigation-support/kroll-artifact-parser-extractor-kape) : KAPE est un programme de triage conçu pour aider à collecter et analyser les artefacts de manière rapide et efficace. Il se concentre sur une collecte ciblée, réduisant le volume de données collectées et le temps nécessaire à l'analyse. KAPE est gratuit et constitue un outil essentiel dans notre boîte à outils d'investigation numérique.
-   [Velociraptor](https://github.com/Velocidex/velociraptor) : Velociraptor est un outil polyvalent conçu pour la réponse aux incidents basée sur l'hôte et la criminalistique numérique. Il permet une collecte de données rapide et ciblée sur un grand nombre de machines. Velociraptor utilise Velocidex Query Language (VQL), un outil puissant pour collecter et manipuler des artefacts. La nature open source de Velociraptor en fait un outil gratuit précieux dans notre arsenal.

* * * * *

Définition, objectif et activités courantes de l'analyse des logiciels malveillants
-----------------------------------------------------------------------------------

Le processus de compréhension du comportement et du fonctionnement interne des logiciels malveillants est connu sous le nom `Malware Analysis`d'aspect crucial de la cybersécurité qui aide à comprendre la menace posée par les logiciels malveillants et à concevoir des contre-mesures efficaces.

Dans notre quête d'analyse des logiciels malveillants, nous examinons le code, la structure et les fonctionnalités des logiciels malveillants pour obtenir des informations approfondies sur leur objectif, leurs méthodes de propagation et leur impact potentiel sur les systèmes ciblés. En répondant à des questions pertinentes, telles que le type de malware (par exemple, spybot, keylogger, ransomware), son comportement prévu sur les points finaux, les conséquences de son exécution (y compris les artefacts générés sur le réseau ou le point final et les connexions possibles à Command and Control (C2 ) serveurs), l'étendue des dommages qu'il peut infliger, son attribution à des groupes de menaces spécifiques et l'élaboration de règles de détection basées sur l'analyse pour détecter le malware sur l'ensemble du réseau, nous pouvons concevoir des mécanismes de défense robustes contre ces menaces.

L'analyse des logiciels malveillants sert plusieurs éléments essentiels `purposes`, tels que :

-   `Detection and Classification`: Grâce à l'analyse des logiciels malveillants, nous pouvons identifier et classer différents types de menaces en fonction de leurs caractéristiques, signatures ou modèles uniques. Cela nous permet de développer des règles de détection et permet aux professionnels de la sécurité d'acquérir une compréhension globale de la nature des logiciels malveillants qu'ils rencontrent.

-   `Reverse Engineering`: L'analyse des logiciels malveillants implique souvent le processus complexe de rétro-ingénierie du code du logiciel malveillant pour discerner ses opérations sous-jacentes et les techniques utilisées. Cela peut révéler des fonctionnalités cachées, des méthodes de cryptage, des détails sur l'infrastructure de commande et de contrôle et des techniques utilisées pour l'obscurcissement et l'évasion.

-   `Behavioral Analysis`: En étudiant méticuleusement le comportement des logiciels malveillants lors de leur exécution, nous obtenons des informations sur leurs actions, telles que les modifications du système de fichiers, les communications réseau, les modifications du registre système et les tentatives d'exploitation des vulnérabilités. Cette analyse fournit des informations précieuses sur l'impact du malware sur les systèmes infectés et aide à concevoir des contre-mesures potentielles.

-   `Threat Intelligence`: Grâce à l'analyse des logiciels malveillants, les chercheurs en menaces peuvent recueillir des renseignements essentiels sur les attaquants, leurs tactiques, techniques et procédures (TTP) ainsi que sur les origines des logiciels malveillants. Ces renseignements précieux peuvent être partagés avec l'ensemble de la communauté de la sécurité pour améliorer les capacités de détection, de prévention et de réponse.

Les `techniques`outils utilisés dans l'analyse des logiciels malveillants englobent un large éventail de méthodes et d'outils, notamment :

-   `Static Analysis`: Cette approche consiste à examiner le code du malware sans l'exécuter, à examiner la structure du fichier, à identifier les chaînes, à rechercher des signatures connues et à étudier les métadonnées pour obtenir un aperçu préliminaire des caractéristiques du malware.

-   `Dynamic Analysis`: L'analyse dynamique implique l'exécution du malware dans un environnement contrôlé, tel qu'un bac à sable ou une machine virtuelle, pour observer son comportement et capturer ses activités d'exécution. Cela inclut la surveillance du trafic réseau, des appels système, des modifications du système de fichiers et d'autres interactions.

-   `Code Analysis`: Analyse du code (inclut l'ingénierie inverse) et implique le désassemblage ou la décompilation du code du malware pour comprendre sa logique, ses fonctions, ses algorithmes et les techniques utilisées. Cela aide à identifier les fonctionnalités cachées, les méthodes d'exploitation, les méthodes de cryptage, les détails sur l'infrastructure de commande et de contrôle et les techniques utilisées pour l'obscurcissement et l'évasion. En fait, l'analyse du code peut également aider à découvrir d'éventuels indicateurs de compromission (IOC).

-   `Memory Analysis`: L'analyse des interactions du malware avec la mémoire système aide à identifier le code injecté, les hooks ou autres manipulations d'exécution. Cela peut jouer un rôle déterminant dans la détection des rootkits, l'analyse des techniques anti-analyse ou l'identification des charges utiles malveillantes.

-   `Malware Unpacking`: Cette technique fait référence au processus d'extraction et d'isolement du code malveillant caché dans un logiciel malveillant qui utilise des techniques de compression pour échapper à la détection. Les packers sont utilisés par les auteurs de logiciels malveillants pour compresser, chiffrer ou masquer leur code malveillant, ce qui rend plus difficile l'identification de la menace par les logiciels antivirus et autres outils de sécurité. Le déballage implique une rétro-ingénierie de ces techniques d'emballage pour révéler le code original non obscurci pour une analyse plus approfondie. Cela peut permettre aux chercheurs de comprendre la fonctionnalité, le comportement et l'impact potentiel du logiciel malveillant.

* * * * *

Dans le paysage actuel des menaces en constante évolution, l'utilisation de l'analyse des logiciels malveillants joue un rôle central dans nos stratégies de défense en matière de cybersécurité. Alors que les cybermenaces deviennent de plus en plus sophistiquées, nous devons continuellement améliorer nos capacités à identifier, analyser et atténuer les risques posés par les logiciels malveillants.

Grâce à l'analyse des logiciels malveillants, nous obtenons des informations inestimables sur la nature des menaces auxquelles nous sommes confrontés. Comprendre les attributs spécifiques des logiciels malveillants nous permet d'adapter nos tactiques de réponse en conséquence, en traitant chaque menace avec précision.